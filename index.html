<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Budget Tracker</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>üí∞ Budget Tracker</h1>
            <div class="header-actions">
                <button class="export-btn" onclick="budgetTracker.openExportMenu()">
                    üíæ Export Data
                </button>
            </div>
            <nav>
                <button class="tab-button active" data-tab="setup">Budget Setup</button>
                <button class="tab-button" data-tab="tracking">Track Spending</button>
                <button class="tab-button" data-tab="history">Spending History</button>
            </nav>
        </header>

        <!-- Budget Setup Tab -->
        <section id="setup" class="tab-content active">
            <h2>üìã Set Budget Categories</h2>
            <div class="category-setup">
                <div class="input-group">
                    <input type="text" id="category-name" placeholder="Category name (e.g., Groceries)">
                    <input type="number" id="category-budget" placeholder="Budget amount" step="0.01">
                    <button id="add-category">Add Category</button>
                </div>
                <div id="categories-list"></div>
                <div class="total-budget">
                    <h3>Total Monthly Budget: $<span id="total-budget">0.00</span></h3>
                </div>
            </div>
        </section>

        <!-- Track Spending Tab -->
        <section id="tracking" class="tab-content">
            <h2>üìù Track Your Spending</h2>
            <div class="tracking-form">
                <div class="input-group">
                    <select id="spending-category">
                        <option value="">Select Category</option>
                    </select>
                    <input type="number" id="spending-amount" placeholder="Amount spent" step="0.01">
                    <input type="date" id="spending-date" value="">
                    <input type="text" id="spending-note" placeholder="Note (optional)">
                    <button id="add-spending">Add Spending</button>
                </div>
            </div>
            
            <div class="current-budgets">
                <h3>Current Budget Status</h3>
                <div id="budget-status"></div>
            </div>
            
            <div class="recent-transactions">
                <h3>Recent Transactions</h3>
                <div class="transaction-filters">
                    <input type="text" id="search-notes" placeholder="üîç Search notes..." class="search-input">
                    <select id="filter-category">
                        <option value="all">All Categories</option>
                    </select>
                </div>
                <div id="transactions-list"></div>
            </div>
        </section>

        <!-- Spending History Tab -->
        <section id="history" class="tab-content">
            <h2>üìä Spending History</h2>
            <div class="chart-controls">
                <div class="control-group">
                    <label for="chart-category">Category:</label>
                    <select id="chart-category">
                        <option value="all">All Categories</option>
                    </select>
                </div>

                <div class="control-group">
                    <label for="chart-note">Note:</label>
                    <input type="text" id="chart-note" placeholder="Filter by note"/>
                </div>
                
                <div class="control-group">
                    <label for="chart-note">Notes:</label>
                     <input type="text" id="chart-note" placeholder="note (e.g., birthday)">
                </div>
                
                <div class="control-group">
                    <label for="chart-grouping">Group By:</label>
                    <select id="chart-grouping">
                        <option value="day">Daily</option>
                        <option value="week">Weekly</option>
                        <option value="month">Monthly</option>
                        <option value="year">Yearly</option>
                    </select>
                </div>
                
                <div class="control-group">
                    <label for="chart-timeframe">Timeframe:</label>
                    <select id="chart-timeframe">
                        <option value="7days">Last 7 Days</option>
                        <option value="30days">Last 30 Days</option>
                        <option value="3months">Last 3 Months</option>
                        <option value="6months">Last 6 Months</option>
                        <option value="1year">Last Year</option>
                        <option value="all">All Time</option>
                        <option value="custom">Custom Range</option>
                    </select>
                </div>
            </div>
            
            <!-- Custom Date Range (hidden by default) -->
            <div id="custom-range" class="custom-range" style="display: none;">
                <div class="input-group">
                    <input type="date" id="start-date" value="">
                    <input type="date" id="end-date" value="">
                    <button id="apply-date-range">Apply Range</button>
                </div>
            </div>
            
            <div class="chart-container">
                <canvas id="spendingChart"></canvas>
            </div>
            
            <div class="chart-summary">
                <div class="summary-stat">
                    <span class="stat-label">Total Shown:</span>
                    <span class="stat-value" id="total-shown">$0.00</span>
                </div>
                <div class="summary-stat">
                    <span class="stat-label">Average per Period:</span>
                    <span class="stat-value" id="average-period">$0.00</span>
                </div>
                <div class="summary-stat">
                    <span class="stat-label">Highest Period:</span>
                    <span class="stat-value" id="highest-period">$0.00</span>
                </div>
                <div class="summary-stat">
                    <span class="stat-label">Periods Shown:</span>
                    <span class="stat-value" id="periods-count">0</span>
                </div>
            </div>
            
            <div class="data-table-container">
                <h3>üìã Detailed Data</h3>
                <div class="table-wrapper">
                    <table id="data-table">
                        <thead>
                            <tr>
                                <th>Period</th>
                                <th>Category</th>
                                <th>Amount</th>
                                <th>Transactions</th>
                            </tr>
                        </thead>
                        <tbody id="table-body">
                            <!-- Data will be inserted here -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div class="notes-summary">
                <h3>üìù Recent Notes</h3>
                <div id="notes-list"></div>
            </div>
        </section>


    </div>

            <!-- Edit Transaction Modal -->
    <div id="edit-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h3>Edit Transaction</h3>
            <div class="modal-form">
                <select id="edit-category">
                    <option value="">Select Category</option>
                </select>
                <input type="number" id="edit-amount" placeholder="Amount" step="0.01">
                <input type="date" id="edit-date">
                <input type="text" id="edit-note" placeholder="Note">
                <div class="modal-buttons">
                    <button id="save-edit">Save Changes</button>
                    <button id="cancel-edit" class="cancel-btn">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Export Menu Modal -->
    <div id="export-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="budgetTracker.closeExportMenu()">&times;</span>
            <h3>üì§ Export Data</h3>
            <div class="export-options">
                <div class="export-option">
                    <h4>Quick Export</h4>
                    <button class="export-format-btn" onclick="budgetTracker.exportJSON()">
                        üìÑ Export as JSON
                    </button>
                    <button class="export-format-btn" onclick="budgetTracker.exportCSV()">
                        üìä Export as CSV
                    </button>
                    <button class="export-format-btn" onclick="budgetTracker.exportExcel()">
                        üìà Export as Excel
                    </button>
                    <button class="export-format-btn" onclick="budgetTracker.copyToClipboard()">
                        üìã Copy to Clipboard
                    </button>
                 </div>
                   
                <div class="export-option">
                    <h4>Backup & Restore</h4>
                    <button class="export-format-btn" onclick="budgetTracker.createBackup()">
                        üíæ Create Full Backup
                    </button>
                    <button class="export-format-btn" onclick="budgetTracker.downloadBackup()">
                        ‚¨áÔ∏è Download Backup File
                    </button>
                    <div class="import-section">
                        <label for="import-file">Import Backup:</label>
                        <input type="file" id="import-file" accept=".json,.csv,.txt">
                        <button onclick="budgetTracker.importFromFile()">Import Data</button>
                    </div>
                </div>
                    
                <div class="export-option">
                    <h4>Advanced Options</h4>
                    <button class="export-format-btn" onclick="budgetTracker.exportPDF()">
                        üì∞ Export as PDF Report
                    </button>
                    <button class="export-format-btn" onclick="budgetTracker.printReport()">
                        üñ®Ô∏è Print Report
                    </button>
                    <button class="export-format-btn" onclick="budgetTracker.clearAllData()" style="background: #ff4757;">
                        üóëÔ∏è Clear All Data
                    </button>
                </div>
            </div>
                
            <div class="export-preview">
                <h4>Data Preview</h4>
                <div class="data-stats">
                    <div class="data-stat">
                        <span>Categories:</span>
                        <span id="preview-categories">0</span>
                    </div>
                    <div class="data-stat">
                        <span>Transactions:</span>
                        <span id="preview-transactions">0</span>
                    </div>
                    <div class="data-stat">
                        <span>Total Spent:</span>
                        <span id="preview-total">$0.00</span>
                    </div>
                    <div class="data-stat">
                        <span>Last Backup:</span>
                        <span id="preview-backup">Never</span>
                    </div>
                </div>
                <div class="preview-data">
                    <textarea id="data-preview" readonly placeholder="Data preview will appear here..."></textarea>
                </div>
            </div>
        </div>
    </div>

        <!-- Import Confirmation Modal -->
        <div id="import-modal" class="modal">
            <div class="modal-content">
                <span class="close-modal" onclick="budgetTracker.closeImportModal()">&times;</span>
                <h3>‚ö†Ô∏è Import Data</h3>
                <div id="import-confirm-content">
                    <p>Are you sure you want to import this data?</p>
                    <div id="import-preview"></div>
                    <div class="import-options">
                        <label>
                            <input type="radio" name="import-mode" value="replace" checked> 
                            Replace all existing data
                        </label>
                        <label>
                            <input type="radio" name="import-mode" value="merge"> 
                            Merge with existing data (keep both)
                        </label>
                    </div>
                    <div class="modal-buttons">
                        <button id="confirm-import" onclick="budgetTracker.confirmImport()">Import Data</button>
                        <button onclick="budgetTracker.closeImportModal()" class="cancel-btn">Cancel</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Success/Error Message Modal -->
        <div id="message-modal" class="modal">
            <div class="modal-content" style="max-width: 400px;">
                <h3 id="message-title">Success!</h3>
                <p id="message-content">Operation completed successfully.</p>
                <div class="modal-buttons">
                    <button onclick="budgetTracker.closeMessageModal()">OK</button>
                </div>
            </div>
        </div>
    </div>


    <script src="script.js"></script>
</body>
</html>